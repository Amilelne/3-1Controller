<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="xmu.crms.mapper.ClassMapper">
<!--1-->
<resultMap type="xmu.crms.entity.ClassInfo" id="ClassInfoResultMap">
    <id column="id" property="id"/>
    <result column="name" property="name"/>
    <result column="course_id" property="course.id"/>
    <result column="site" property="site"/>
    <result column="class_time" property="classTime"/>
    <result column="report_percentage" property="reportPercentage"/>
    <result column="presentation_percentage" property="presentationPercentage"/>
    <result column="five_point_percentage" property="fivePointPercentage"/>
    <result column="four_point_percentage" property="fourPointPercentage"/>
    <result column="three_point_percentage" property="threePointPercentage"/>
</resultMap>

<!--2-->
<resultMap type="xmu.crms.entity.Location" id="LocationResultMap">
    <id column="id" property="id"/>
    <result column="class_id" property="classInfo.id"/>
    <result column="seminar_id" property="seminar.id"/>
    <result column="longtitude" property="BigIntegeritude"/>
    <result column="latitude" property="latitude"/>
    <result column="status" property="status"/>
</resultMap>
<delete id="deleteClassSelectionByClassId" >
delete from course_selection where class_id=#{classId};
</delete>
<!--1-->
<select id="listClassByName" resultMap="ClassInfoResultMap">
select class_info.* from class_info,user_info,course where course.name=#{courseName}  and course.teacher_id=user_info.id and user_info.name=#{teacherName} and course.id=class_info.course_id ;
</select>

<select id="listClassByCourseId" resultMap="ClassInfoResultMap">
select class_info.* from class_info  where  class_info.course_id=#{courseId.longValue()};
</select>

<select id="getClassByClassId" resultMap="ClassInfoResultMap">
select * from class_info where id=#{classId.longValue()};
</select>
<update id="updateClassByClassId">
	update class_info set name=#{newClass.name},site=#{newClass.site},
	course_id=#{newClass.course.id},class_time=#{newClass.classTime},
	report_persentage=#{newClass.reportPercentage},five_point_persentage=#{newClass.fivePointPercentage},
	four_point_persentage=#{newClass.fourPointPercentage},three_point_persentage=#{newClass.threePointPercentage},
	where id=#{classId};
</update>

<delete id="deleteClassByClassId">
delete from class_info where id=#{classId.longValue()};
</delete>

<insert id="insertCourseSelectionById">
insert into course_selection(class_id,student_id) values(classId.longValue(),userId.longValue());
</insert>

<delete id="deleteCourseSelectionById">
delete from course_selection where class_id=#{classId.longValue()} and student_Id=#{userId.longValue()};
</delete>
<!--2有问题不懂，返回值应该是location-->
<select id="getCallStatusById" resultMap="LocationResultMap">
    select * from location where seminar_id=#{seminarId};
</select>

<insert id="insertClassById">
insert into class_info(name,course_id) values("周三三四节",#{courseId});
</insert>

<delete id="deleteClassByCourseId">
delete from class_info where course_id=#{courseId};
</delete>

<!--ScoreRule表已经删除,以下的表可以做空方法来实现-->
<update id="deleteScoreRuleById">
</update>

<select id="getScoreRule" resultMap="ClassInfoResultMap">
</select>

<insert id="insertScoreRule">
</insert>

<update id="updateScoreRule">
</update>
</mapper>
